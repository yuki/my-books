name: Pandoc Books Build
on: workflow_dispatch
permissions:
  contents: write
  pages: write
  id-token: write
jobs:
  build:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
    - name: Set up Git repository
      uses: actions/checkout@v4
      with:
        submodules: recursive
    - name: build the PDF and HTML
      uses: dante-ev/latex-action@latest
      with:
        entrypoint: ./build_pandoc.sh
    - name: Release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: latest
        files: |
          otros/aws/aws_book.pdf
    - name: Upload artifacts
      uses: actions/upload-pages-artifact@v2
      with:
        path: './build'
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v2
